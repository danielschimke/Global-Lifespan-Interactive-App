---
title: "Extract / Transform / Load"
author: '...'
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    code_folding: hide
    df_print: paged
    geometry: margin=2cm
    highlight: textmate
    theme: journal
  pdf_document: default
---
<style type="text/css">
.main-container {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
</style>

# Project Initation

```{r setup-vars, include=FALSE}
library(tidyverse)
library(DBI)
library(RCurl)


newData <- "data.db"
con <- dbConnect(drv = RSQLite::SQLite(), dbname = newData)
dbListTables(con)


LEdata <- read_csv('life-expectancy.csv')
CMdata <- read.csv('child-mortality-igme.csv')

totalData <- merge.data.frame(LEdata, CMdata, by=c("Entity", "Year", "Code"), all=TRUE)
totalData <- rename(totalData, c("childMortality" = "Child.mortality....",
                                 "lifeExpectancy" = "Life expectancy (years)"))

dbWriteTable(con, "Merged Table", totalData, overwrite = TRUE)

dataRead <- dbReadTable(con, "Merged Table")

dbDisconnect(con)
```
